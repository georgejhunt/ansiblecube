---

- name: Configure logrotate to handle our custom logs.
  template: src={{ item.src }} dest=/etc/logrotate.d/{{ item.dest }} owner=root group=root mode=0644
  with_items:
    - src: 000-dateext-for-all.j2
      dest: 000-dateext-for-all
    - src: ansible-pull.logrotate.j2
      dest: ansible-pull
    - src: dpkg-list.logrotate.j2
      dest: dpkg-list
    - src: pip-freeze.logrotate.j2
      dest: pip-freeze

- name: copy hdw info script
  copy: src=hdw_info.sh dest=/home/ideascube/hdw_info.sh mode=755 remote_src=true

- name: Copy push_log.sh
  template: src=push_log.sh.j2 dest=/etc/NetworkManager/dispatcher.d/push_log mode=755

- name: Remove old way launching logs files script
  file: path=/etc/dhcp/dhclient-exit-hooks.d/push_log state=absent

- name: fix rights on ansible-pull.log
  file: path=/var/log/ansible-pull.log mode=0644 group=adm
